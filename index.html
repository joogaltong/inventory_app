<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>올파포 4단지 재고관리</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="./assets/foreon-logo.png" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <section id="auth-gate" class="auth-gate" aria-hidden="true">
      <article class="auth-card">
        <div class="auth-hero">
          <p class="auth-brand">올파포 4단지 재고관리</p>
          <img class="auth-logo" src="./assets/foreon-logo.png" alt="올파포 로고" />
        </div>
        <form id="auth-form" class="auth-form">
          <input id="auth-username" autocomplete="username" placeholder="ID" required />
          <input id="auth-password" type="password" autocomplete="current-password" placeholder="PW" required />
          <button type="submit" class="auth-submit-btn">로그인</button>
        </form>
        <p id="auth-status" class="status-text auth-status"></p>
      </article>
    </section>

    <main class="app-shell">
      <header class="app-header">
        <div class="brand-wrap">
          <img class="app-logo" src="./assets/foreon-logo.png" alt="올파포 로고" />
          <div>
            <p class="eyebrow">올파포 4단지 재고관리</p>
            <h1 id="screen-title">올파포 4단지 재고관리</h1>
          </div>
        </div>
        <span id="today-badge" class="today-badge">-</span>
      </header>

      <section id="view-home" class="view is-active">
        <section class="stats-grid">
          <article class="stat-card">
            <p>총 품목</p>
            <strong id="stat-items">0</strong>
          </article>
          <article class="stat-card">
            <p>총 재고</p>
            <strong id="stat-total">0</strong>
          </article>
          <article class="stat-card">
            <p>이번달 입고</p>
            <strong id="stat-in">0</strong>
          </article>
          <article class="stat-card">
            <p>이번달 출고</p>
            <strong id="stat-out">0</strong>
          </article>
        </section>

        <section class="panel">
          <div class="panel-head">
            <h2>빠른 이동</h2>
            <p>필요한 화면으로 바로 들어가기</p>
          </div>
          <div class="quick-grid">
            <button class="quick-btn" type="button" data-go-view="records">입출고 등록</button>
            <button class="quick-btn" type="button" data-go-view="stock">현재고 확인</button>
            <button class="quick-btn" type="button" data-go-view="settings">백업/복원</button>
          </div>
        </section>

        <section class="panel">
          <div class="panel-head">
            <h2>재고 부족</h2>
            <p>최소 재고 이하 품목</p>
          </div>
          <ul id="low-list" class="low-list"></ul>
          <p id="low-empty" class="empty-text">현재 부족 품목이 없습니다.</p>
        </section>
      </section>

      <section id="view-records" class="view">
        <article class="panel">
          <div class="panel-head">
            <h2>입출고 등록</h2>
            <p>저장하면 바로 재고에 반영됩니다.</p>
          </div>
          <form id="tx-form" class="tx-form">
            <label class="field">
              <span>품목명</span>
              <input id="tx-item" required placeholder="예: 주방세제" />
            </label>

            <div class="field-grid">
              <label class="field">
                <span>구분</span>
                <select id="tx-type">
                  <option value="입고">입고</option>
                  <option value="출고">출고</option>
                </select>
              </label>
              <label class="field">
                <span>수량</span>
                <input id="tx-qty" type="number" min="1" step="1" required />
              </label>
            </div>

            <div class="field-grid">
              <label class="field">
                <span>날짜</span>
                <input id="tx-date" type="date" required />
              </label>
              <label class="field">
                <span>렉바코드 (선택)</span>
                <div class="input-action-row">
                  <input id="tx-rack" placeholder="예: 4F-A1" />
                  <button id="scan-rack-btn" type="button" class="scan-btn">스캔</button>
                </div>
              </label>
            </div>

            <label class="field">
              <span>물품바코드 (선택)</span>
              <div class="input-action-row">
                <input id="tx-barcode" placeholder="예: 880..." />
                <button id="scan-barcode-btn" type="button" class="scan-btn">스캔</button>
              </div>
            </label>

            <label class="field">
              <span>메모 (선택)</span>
              <input id="tx-note" placeholder="필요시 메모" />
            </label>

            <button type="submit" class="primary-btn">저장하기</button>
          </form>
          <p id="tx-form-status" class="status-text">품목명을 입력하면 기준표 품목과 자동 매칭합니다.</p>
        </article>

        <article class="panel">
          <div class="panel-head">
            <h2>입출고 기록</h2>
            <p>최신순으로 표시</p>
          </div>

          <div class="toolbar">
            <input id="tx-search" placeholder="품목명/바코드 검색" />
            <div id="tx-filter" class="segmented">
              <button type="button" class="seg is-active" data-type="전체">전체</button>
              <button type="button" class="seg" data-type="입고">입고</button>
              <button type="button" class="seg" data-type="출고">출고</button>
            </div>
          </div>

          <div id="tx-list" class="tx-list"></div>
          <p id="tx-empty" class="empty-text">표시할 기록이 없습니다.</p>
        </article>
      </section>

      <section id="view-stock" class="view">
        <article class="panel">
          <div class="panel-head">
            <h2>현재고 관리</h2>
            <p>최소재고를 입력하면 부족 알림에 반영됩니다. (분류/구역 필터 적용)</p>
          </div>

          <div class="stock-toolbar">
            <input id="stock-search" class="stock-search-input" placeholder="품목명/렉바코드/물품바코드 검색" />
            <div id="stock-zone-filter" class="segmented">
              <button type="button" class="seg is-active" data-zone="전체">전체</button>
              <button type="button" class="seg" data-zone="피트니스">피트니스</button>
              <button type="button" class="seg" data-zone="게스트하우스">게스트하우스</button>
              <button type="button" class="seg" data-zone="계단실">계단실</button>
            </div>
          </div>

          <div class="stock-wrap">
            <table class="stock-table">
              <thead>
                <tr>
                  <th>품목명</th>
                  <th>분류</th>
                  <th>구역</th>
                  <th>렉바코드</th>
                  <th>물품바코드</th>
                  <th>창고보유수량</th>
                  <th>최소재고</th>
                  <th>상태</th>
                </tr>
              </thead>
              <tbody id="stock-body"></tbody>
            </table>
          </div>

          <p id="stock-empty" class="empty-text">등록된 품목이 없습니다.</p>
        </article>
      </section>

      <section id="view-settings" class="view">
        <article class="panel">
          <div class="panel-head">
            <h2>데이터 관리</h2>
            <p>JSON 백업/복원으로 데이터 이동</p>
          </div>

          <div class="settings-grid">
            <button id="export-json-btn" type="button" class="ghost-btn">백업 파일 저장 (.json)</button>
            <label class="file-btn">
              <input id="import-json-file" type="file" accept="application/json" />
              백업 파일 불러오기
            </label>
            <button id="clear-data-btn" type="button" class="danger-btn">모든 데이터 초기화</button>
            <button id="logout-btn" type="button" class="ghost-btn">로그아웃</button>
          </div>

          <p id="settings-status" class="status-text">백업 또는 복원을 선택하세요.</p>
        </article>

        <article class="panel">
          <div class="panel-head">
            <h2>회사 엑셀 연동 (4단지)</h2>
            <p>기준표를 불러오고, 앱 출고기록을 날짜 칸에 반영해 저장</p>
          </div>

          <div class="settings-grid">
            <label class="file-btn">
              <input id="company-excel-file" type="file" accept=".xlsx,.xls" />
              4단지 기준표 불러오기
            </label>
            <button id="export-company-btn" type="button" class="ghost-btn">회사엑셀 반영 저장</button>
            <button id="export-company-zones-btn" type="button" class="ghost-btn">구역별 양식 내보내기</button>
          </div>

          <p id="company-status" class="status-text">기준표 파일을 먼저 불러오세요.</p>
        </article>

        <article class="panel">
          <div class="panel-head">
            <h2>구글시트 바코드 동기화</h2>
            <p>품목명 기준으로 물품바코드/렉바코드만 업데이트</p>
          </div>

          <div class="sync-row">
            <input id="gsheet-url" placeholder="구글시트 URL 붙여넣기" />
            <button id="gsheet-sync-btn" type="button" class="ghost-btn">URL 동기화</button>
          </div>

          <div class="settings-grid">
            <label class="file-btn">
              <input id="gsheet-csv-file" type="file" accept=".csv,text/csv" />
              CSV 파일 동기화
            </label>
          </div>

          <p id="gsheet-status" class="status-text">바코드 동기화를 아직 하지 않았습니다.</p>
        </article>
      </section>

      <nav id="bottom-nav" class="bottom-nav" role="tablist" aria-label="앱 메뉴">
        <button class="nav-btn is-active" data-view="home" type="button">홈</button>
        <button class="nav-btn" data-view="records" type="button">기록</button>
        <button class="nav-btn" data-view="stock" type="button">재고</button>
        <button class="nav-btn" data-view="settings" type="button">설정</button>
      </nav>
    </main>

    <section id="barcode-scanner-modal" class="scanner-modal" aria-hidden="true">
      <article class="scanner-card">
        <div class="scanner-head">
          <h3 id="scanner-title">바코드 스캔</h3>
          <button id="scanner-close-btn" type="button" class="scanner-close-btn">닫기</button>
        </div>
        <div class="scanner-video-wrap">
          <video id="scanner-video" class="scanner-video" autoplay playsinline muted></video>
          <div class="scanner-overlay" aria-hidden="true"></div>
        </div>
        <p id="scanner-status" class="scanner-status">카메라 준비 중...</p>
      </article>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="./user-config.js"></script>
    <script src="./app.js"></script>
  </body>
</html>
